{"entries":[{"timestamp":1739289345831,"editorVersion":"7.0.57","changes":[{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0,"\": \""],[-1,"PID [FINAL]"],[1,"TEST PID"],[0,"\",\n "]],"start1":11,"start2":11,"length1":19,"length2":16}]}]},{"timestamp":1739289353831,"editorVersion":"7.0.57","changes":[{"type":"edited","filename":"main.blocks","patch":[{"diffs":[[0,"id=\""],[-1,"HDZTfN_*q4Du|=c15q85\">start_time</variable><variable id=\"{Ak0_jFHgtRXH=5]7s)c\">input_buton2</variable><variable id=\"a-atZqn{#g#jW`%$w0rt\">MIN_SPEED</variable><variable id=\"WBI|@nC=/61h-Wr)==F.\">TIME_LIMIT</variable><variable id=\"7G.g}@D@HQAHc-8[E61D\">distance</variable><variable id=\"`BSn@ehxA}nuMA4+7;_1\">MIN_DISTANCE</variable><variable id=\"Q.BS.j$J{W2:DR1_9WHP\">error</variable><variable id=\"96$KDuSi`R`++F|VG/oG\">previous_error</variable><variable id=\"dcXrZ*hvFz?q=BD)He3W\">integral</variable><variable id=\"6TA.Ph/%)9F?MB^%dglr\">INTEGRAL_LIMIT</variable><variable id=\"p;8I4Ebg{G}+,/^nH9`R\">derivative</variable><variable id=\"Qj}D%r/B^iW[sxFCa/A$\">correction</variable><variable id=\"LOXEq#_+XAtn(ozVRe,c\">Kp</variable><variable id=\"+uv9od*T:!D?y$a{v;a[\">Ki</variable><variable id=\"bxX1gv|Um(5lC*9d;/SQ\">Kd</variable><variable id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</variable><variable id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</variable><variable id=\"m1|?5CZ^K,}YU$]8ZtRU\">base_speed</variable><variable id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</variable><variable id=\"?k+X-kOS6IgUc@]EIVxw\">input_buton</variable></variables><block type=\"device_forever\" x=\"360\" y=\"-52\"><statement name=\"HANDLER\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let input_buton2: boolean;\" numlines=\"1\" declaredvars=\"input_buton2\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let MIN_SPEED: number;\" numlines=\"1\" declaredvars=\"MIN_SPEED\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let distance: number;\" numlines=\"1\" declaredvars=\"distance\"></mutation><next><block type=\"controls_if\"><comment pinned=\"false\" h=\"80\" w=\"160\">Si le bouton A est préssé, input_buton passe a True\net permet au programme présent dans la boucle\nwhile de s'activer</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"HDZTfN_*q4Du|=c15q85\">start_time</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{Ak0_jFHgtRXH=5]7s)c\">input_buton2</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></next></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.B</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></value></block></value><statement name=\"DO0\"><block type=\"control_reset\"></block></statement><next><block type=\"device_while\"><value name=\"COND\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{Ak0_jFHgtRXH=5]7s)c\">input_buton2</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></value><statement name=\"DO\"><block type=\"variables_set\"><field name=\"VAR\" id=\"a-atZqn{#g#jW`%$w0rt\">MIN_SPEED</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><next><block type=\"controls_if\"><comment pinned=\"false\" h=\"80\" w=\"160\">Chronomètre : Arrêter le robot au bout du temps limite\ncontrol.millis() - start_time équivaut au temps actuel</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"HDZTfN_*q4Du|=c15q85\">start_time</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"WBI|@nC=/61h-Wr)==F.\">TIME_LIMIT</field></block></value></block></value><statement name=\"DO0\"><block type=\"motor_motorStop\"><field name=\"motors\">maqueen.Motors.All</field><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Square</field><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"return\" numlines=\"1\"></mutation></block></next></block></next></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"7G.g}@D@HQAHc-8[E61D\">distance</field><comment pinned=\"false\" h=\"80\" w=\"160\">Arrête l'exécution de la fonction\nDétection des obstacles avec le capteur à ultrasons</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"ultrasonic_sensor\"></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"7G.g}@D@HQAHc-8[E61D\">distance</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"7G.g}@D@HQAHc-8[E61D\">distance</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`BSn@ehxA}nuMA4+7;_1\">MIN_DISTANCE</field></block></value></block></value></block></value><statement name=\"DO0\"><block type=\"motor_motorStop\"><field name=\"motors\">maqueen.Motors.All</field><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.No</field><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"return\" numlines=\"1\"></mutation></block></next></block></next></block></statement><next><block type=\"controls_if\"><mutation elseif=\"2\" else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Arrête l'exécution de la fonction pour éviter les collisions\nDétection des capteurs de ligne</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-1</field></shadow></value></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO1\"><block type=\"variables_set\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></statement><value name=\"IF2\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO2\"><block type=\"variables_set\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"variables_set\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"96$KDuSi`R`++F|VG/oG\">previous_error</field></block></value></block></statement><next><block type=\"variables_change\"><field name=\"VAR\" id=\"dcXrZ*hvFz?q=BD)He3W\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">Maintient de l'erreur précédente si aucune ligne détectée\nPID</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"dcXrZ*hvFz?q=BD)He3W\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><value name=\"ccsc7jvhgdinuxi8yosa3\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"dcXrZ*hvFz?q=BD)He3W\">integral</field></block></value><value name=\"lh539rrrzldeprsm2ppw\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"6TA.Ph/%)9F?MB^%dglr\">INTEGRAL_LIMIT</field></block></value></block></value><value name=\"3v912koahdhynv7rq4pk\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"6TA.Ph/%)9F?MB^%dglr\">INTEGRAL_LIMIT</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"p;8I4Ebg{G}+,/^nH9`R\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">Anti-windup</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"96$KDuSi`R`++F|VG/oG\">previous_error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Qj}D%r/B^iW[sxFCa/A$\">correction</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><value name=\"ccsc7jvhgdinuxi8yosa3\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"LOXEq#_+XAtn(ozVRe,c\">Kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"+uv9od*T:!D?y$a{v;a[\">Ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"dcXrZ*hvFz?q=BD)He3W\">integral</field></block></value></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"bxX1gv|Um(5lC*9d;/SQ\">Kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"p;8I4Ebg{G}+,/^nH9`R\">derivative</field></block></value></block></value></block></value><value name=\"lh539rrrzldeprsm2ppw\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field></block></value></block></value><value name=\"3v912koahdhynv7rq4pk\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field><comment pinned=\"false\" h=\"80\" w=\"160\">Calcul des vitesses</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><value name=\"ccsc7jvhgdinuxi8yosa3\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"m1|?5CZ^K,}YU$]8ZtRU\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Qj}D%r/B^iW[sxFCa/A$\">correction</field></block></value></block></value><value name=\"lh539rrrzldeprsm2ppw\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"a-atZqn{#g#jW`%$w0rt\">MIN_SPEED</field></block></value><value name=\"3v912koahdhynv7rq4pk\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><value name=\"ccsc7jvhgdinuxi8yosa3\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"m1|?5CZ^K,}YU$]8ZtRU\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Qj}D%r/B^iW[sxFCa/A$\">correction</field></block></value></block></value><value name=\"lh539rrrzldeprsm2ppw\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"a-atZqn{#g#jW`%$w0rt\">MIN_SPEED</field></block></value><value name=\"3v912koahdhynv7rq4pk\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Envoi aux moteurs</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field></block></value></block></value></block></statement><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field></block></value></block></value></block></statement><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Enregistrement des données</comment><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field></block></value></block></value><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"96$KDuSi`R`++F|VG/oG\">previous_error</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mise à jour de l'erreur précédente</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"?k+X-kOS6IgUc@]EIVxw\">input_buton</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">FALSE</field></block></value><next><block type=\"dataloggersetcolumntitles\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"col1\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"col2\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"m1|?5CZ^K,}YU$]8ZtRU\">base_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">25</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"LOXEq#_+XAtn(ozVRe,c\">Kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">110</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"+uv9od*T:!D?y$a{v;a[\">Ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">9</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"bxX1gv|Um(5lC*9d;/SQ\">Kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">40</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">40</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"6TA.Ph/%)9F?MB^%dglr\">INTEGRAL_LIMIT</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">20</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"WBI|@nC=/61h-Wr)==F.\">TIME_LIMIT</field><comment pinned=\"false\" h=\"80\" w=\"160\">Temps limite en millisecondes (15 secondes)</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">15000</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"HDZTfN_*q4Du|=c15q85\">start_time</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"`BSn@ehxA}nuMA4+7;_1\">MIN_DISTANCE</field><comment pinned=\"false\" h=\"80\" w=\"160\">Chronomètre initialisé au démarrage\nDistance minimale pour détecter un obstacle en centimètres</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">10</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"2105\" y=\"-52\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><field name=\"function_name\">constrain</field><comment pinned=\"false\" h=\"80\" w=\"160\">Limite pour éviter l'intégration excessive</comment><value name=\"ccsc7jvhgdinuxi8yosa3\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">value</field></block></value><value name=\"lh539rrrzldeprsm2ppw\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">min_val</field></block></value><value name=\"3v912koahdhynv7rq4pk"],[1,"vF#kcHf(HGewpl?)Z%2a\">error</variable><variable id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</variable><variable id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</variable><variable id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</variable><variable id=\"srTtG^Y7w^.knh-{c8E1\">derivative</variable><variable id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</variable><variable id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</variable><variable id=\"wx[A$s;C`-57WI8NLC+B\">Ki</variable><variable id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</variable><variable id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</variable><variable id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</variable><variable id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</variable><variable id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</variable><variable id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"dataloggersetcolumntitles\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"col1\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"col2\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">25</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">10</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"wx[A$s;C`-57WI8NLC+B\">Ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">4</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">50</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"device_forever\" x=\"381\" y=\"0\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation elseif=\"2\" else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Détection des capteurs</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-1</field></shadow></value></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO1\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></statement><value name=\"IF2\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO2\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field></block></value></block></statement><next><block type=\"variables_change\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">Maintient de l'erreur précédente si aucune ligne détectée\nPID</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field></block></value></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"srTtG^Y7w^.knh-{c8E1\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">Anti-windup</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wx[A$s;C`-57WI8NLC+B\">Ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field></block></value></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"srTtG^Y7w^.knh-{c8E1\">derivative</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field><comment pinned=\"false\" h=\"80\" w=\"160\">Calcul des vitesses</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field></block></value></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</field></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field></block></value></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</field></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Envoi aux moteurs</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></value></block></statement><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></value></block></statement><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Enregistrement des données</comment><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></value><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mise à jour de l'erreur précédente</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1650\" y=\"0\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><field name=\"function_name\">constrain</field><comment pinned=\"false\" h=\"80\" w=\"160\">Limite pour éviter l'intégration excessive</comment><value name=\"j7izah9rv7fhx25tbn1f\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">value</field></block></value><value name=\"vtmhtprg1v2xf223mko\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">min_val</field></block></value><value name=\"2errsbui1se12prib2co"],[0,"\"><b"]],"start1":76,"start2":76,"length1":28916,"length2":19227}]},{"type":"edited","filename":"main.py","patch":[{"diffs":[[0,"= 0\n"],[-1,"input_buton = False\n"],[0,"data"]],"start1":304,"start2":304,"length1":28,"length2":8},{"diffs":[[0,"d = "],[-1,"30"],[1,"25"],[0,"\nKp "]],"start1":363,"start2":363,"length1":10,"length2":10},{"diffs":[[0,"IT = 20\n"],[1,"input_buton = False\n\n"],[0,"# Temps "]],"start1":421,"start2":421,"length1":16,"length2":37},{"diffs":[[0,"millis()"],[-1,"\n"],[1,"  "],[0,"# Chrono"]],"start1":536,"start2":536,"length1":17,"length2":18},{"diffs":[[0,"marrage\n"],[1,"\n"],[0,"# Distan"]],"start1":576,"start2":576,"length1":16,"length2":17},{"diffs":[[0,"TANCE = "],[-1,"5"],[1,"10"],[0,"\n\ndef on"]],"start1":653,"start2":653,"length1":17,"length2":18},{"diffs":[[0,"obal"],[-1," start_time,"],[0," err"]],"start1":689,"start2":689,"length1":20,"length2":8},{"diffs":[[0,"evious_error"],[1,", start_time"],[0,"\n    # Si le"]],"start1":762,"start2":762,"length1":24,"length2":36},{"diffs":[[0,"le\n    #"],[-1," "],[0,"while de"]],"start1":894,"start2":894,"length1":17,"length2":16},{"diffs":[[0,"activer\n"],[1,"    \n"],[0,"    if"],[-1," "],[1,"("],[0,"input.bu"]],"start1":913,"start2":913,"length1":23,"length2":28},{"diffs":[[0,"utton.A)"],[-1," "],[0,"== True"],[1,")"],[0,":\n      "]],"start1":958,"start2":958,"length1":24,"length2":24},{"diffs":[[0,"uton"],[-1,"2"],[0," = True\n"],[1,"\n"],[0,"    if"],[-1," "],[1,"("],[0,"inpu"]],"start1":1029,"start2":1029,"length1":24,"length2":24},{"diffs":[[0,"utton.B) == True"],[1,")"],[0,":\n        contro"]],"start1":1120,"start2":1120,"length1":32,"length2":33},{"diffs":[[0,".reset()"],[1,"\n\n    "],[0,"\n    whi"]],"start1":1154,"start2":1154,"length1":16,"length2":22},{"diffs":[[0,"ut_buton"],[-1,"2"],[0," == True"]],"start1":1182,"start2":1182,"length1":17,"length2":16},{"diffs":[[0,"= True:\n"],[1,"        \n        \n"],[0,"        "]],"start1":1192,"start2":1192,"length1":16,"length2":34},{"diffs":[[0,"N_SPEED = 0\n"],[1,"\n"],[0,"        # Ch"]],"start1":1228,"start2":1228,"length1":24,"length2":25},{"diffs":[[0,".SQUARE)"],[1,"  # Indique l'arrêt par le temps"],[0,"\n       "]],"start1":1515,"start2":1515,"length1":16,"length2":48},{"diffs":[[0,"          return"],[-1,"\n      "],[0,"  # Arrête l'exé"]],"start1":1558,"start2":1558,"length1":39,"length2":32},{"diffs":[[0,"onction\n"],[1,"\n"],[0,"        "]],"start1":1604,"start2":1604,"length1":16,"length2":17},{"diffs":[[0,"istance "],[1,"> 0 and distance "],[0,"< MIN_DI"]],"start1":1727,"start2":1727,"length1":16,"length2":33},{"diffs":[[0,"    "],[-1,"return\n      "],[1,"basic.show_icon(IconNames.NO)  # Indique un obstacle\n            return"],[0,"  # "]],"start1":1827,"start2":1827,"length1":21,"length2":79},{"diffs":[[0," collisions\n"],[1,"\n"],[0,"        # Dé"]],"start1":1955,"start2":1955,"length1":24,"length2":25},{"diffs":[[0,"us_error"],[-1,"\n     "],[0,"  "],[-1," "],[0,"# Mainti"]],"start1":2490,"start2":2490,"length1":25,"length2":18},{"diffs":[[0,"étectée\n"],[1,"\n"],[0,"        "]],"start1":2552,"start2":2552,"length1":16,"length2":17},{"diffs":[[0,"tegral, "],[-1,"0 - "],[1,"-"],[0,"INTEGRAL"]],"start1":2632,"start2":2632,"length1":20,"length2":17},{"diffs":[[0,"L_LIMIT)"],[-1,"\n      "],[0,"  # Anti"]],"start1":2664,"start2":2664,"length1":23,"length2":16},{"diffs":[[0,"ive,"],[-1,"\n            0"],[0," -"],[-1," "],[0,"MAX_"]],"start1":2804,"start2":2804,"length1":25,"length2":10},{"diffs":[[0,"X_SPEED,"],[-1,"\n           "],[0," MAX_SPE"]],"start1":2812,"start2":2812,"length1":28,"length2":16},{"diffs":[[0,"EED, MAX_SPEED)\n"],[1,"\n"],[0,"        # Calcul"]],"start1":2816,"start2":2816,"length1":32,"length2":33},{"diffs":[[0,"EED, MAX_SPEED)\n"],[1,"\n"],[0,"        # Envoi "]],"start1":3004,"start2":3004,"length1":32,"length2":33},{"diffs":[[0,"s(right_speed))\n"],[1,"\n"],[0,"        # Enregi"]],"start1":3440,"start2":3440,"length1":32,"length2":33},{"diffs":[[0,", right_speed))\n"],[1,"\n"],[0,"        # Mise à"]],"start1":3610,"start2":3610,"length1":32,"length2":33},{"diffs":[[0,"= error\n"],[1,"\n"],[0,"basic.fo"]],"start1":3695,"start2":3695,"length1":16,"length2":17}]},{"type":"edited","filename":"main.ts","patch":[{"diffs":[[0,"= 0\n"],[-1,"let input_buton = false\n"],[0,"data"]],"start1":362,"start2":362,"length1":32,"length2":8},{"diffs":[[0,"d = "],[-1,"30"],[1,"25"],[0,"\nlet"]],"start1":423,"start2":423,"length1":10,"length2":10},{"diffs":[[0,"IT = 20\n"],[1,"let input_buton = false\n"],[0,"//  Temp"]],"start1":501,"start2":501,"length1":16,"length2":40},{"diffs":[[0,"TANCE = "],[-1,"5"],[1,"10"],[0,"\nbasic.f"]],"start1":752,"start2":752,"length1":17,"length2":18},{"diffs":[[0,"ut_buton"],[-1,"2"],[0,": boolea"]],"start1":812,"start2":812,"length1":17,"length2":16},{"diffs":[[0,"e\n    //"],[-1," "],[0," while d"]],"start1":1001,"start2":1001,"length1":17,"length2":16},{"diffs":[[0,"ut_buton"],[-1,"2"],[0," = true\n"]],"start1":1129,"start2":1129,"length1":17,"length2":16},{"diffs":[[0,"ut_buton"],[-1,"2"],[0," == true"]],"start1":1299,"start2":1299,"length1":17,"length2":16},{"diffs":[[0,"Square)\n"],[1,"            //  Indique l'arrêt par le temps\n"],[0,"        "]],"start1":1621,"start2":1621,"length1":16,"length2":61},{"diffs":[[0,"istance "],[1,"> 0 && distance "],[0,"< MIN_DI"]],"start1":1875,"start2":1875,"length1":16,"length2":32},{"diffs":[[0,"een.Motors.All)\n"],[1,"            basic.showIcon(IconNames.No)\n            //  Indique un obstacle\n"],[0,"            retu"]],"start1":1951,"start2":1951,"length1":32,"length2":109},{"diffs":[[0,"tegral, "],[-1,"0 - "],[1,"-"],[0,"INTEGRAL"]],"start1":2857,"start2":2857,"length1":20,"length2":17},{"diffs":[[0,"ve, "],[-1,"0 - "],[1,"-"],[0,"MAX_"]],"start1":3039,"start2":3039,"length1":12,"length2":9}]},{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0," \"*\""],[-1,",\n        \"pxt-sonar\": \"github:microsoft/pxt-sonar#v0.0.6\""],[0,"\n   "]],"start1":304,"start2":304,"length1":66,"length2":8}]}]},{"timestamp":1741206556961,"editorVersion":"7.0.57","changes":[{"type":"edited","filename":"main.py","patch":[{"diffs":[[0,"iver"],[-1,"\n\n    "],[0,"\n   "]],"start1":913,"start2":913,"length1":14,"length2":8}]}]},{"timestamp":1741207426896,"editorVersion":"7.0.57","changes":[{"type":"edited","filename":"main.py","patch":[{"diffs":[[0,"    "],[-1,"\"\""],[0,"\n   "]],"start1":919,"start2":919,"length1":10,"length2":8}]}]},{"timestamp":1741207427650,"editorVersion":"7.0.57","changes":[{"type":"edited","filename":"main.blocks","patch":[{"diffs":[[0,"iables><"],[1,"block type=\"device_forever\" x=\"360\" y=\"-52\"><statement name=\"HANDLER\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let input_buton2: boolean;\" numlines=\"1\" declaredvars=\"input_buton2\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let MIN_SPEED: number;\" numlines=\"1\" declaredvars=\"MIN_SPEED\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let distance: number;\" numlines=\"1\" declaredvars=\"distance\"></mutation><next><block type=\"controls_if\"><comment pinned=\"false\" h=\"80\" w=\"160\">Si le bouton A est préssé, input_buton passe a True\net permet au programme présent dans la boucle\nwhile de s'activer</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"HDZTfN_*q4Du|=c15q85\">start_time</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{Ak0_jFHgtRXH=5]7s)c\">input_buton2</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></next></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.B</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></value></block></value><statement name=\"DO0\"><block type=\"control_reset\"></block></statement><next><block type=\"device_while\"><value name=\"COND\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{Ak0_jFHgtRXH=5]7s)c\">input_buton2</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block></value></block></value><statement name=\"DO\"><block type=\"variables_set\"><field name=\"VAR\" id=\"a-atZqn{#g#jW`%$w0rt\">MIN_SPEED</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><next><block type=\"controls_if\"><comment pinned=\"false\" h=\"80\" w=\"160\">Chronomètre : Arrêter le robot au bout du temps limite\ncontrol.millis() - start_time équivaut au temps actuel</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"HDZTfN_*q4Du|=c15q85\">start_time</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"WBI|@nC=/61h-Wr)==F.\">TIME_LIMIT</field></block></value></block></value><statement name=\"DO0\"><block type=\"motor_motorStop\"><field name=\"motors\">maqueen.Motors.All</field><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Square</field><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"return\" numlines=\"1\"></mutation></block></next></block></next></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"7G.g}@D@HQAHc-8[E61D\">distance</field><comment pinned=\"false\" h=\"80\" w=\"160\">Arrête l'exécution de la fonction\nDétection des obstacles avec le capteur à ultrasons</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"ultrasonic_sensor\"></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"7G.g}@D@HQAHc-8[E61D\">distance</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"7G.g}@D@HQAHc-8[E61D\">distance</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`BSn@ehxA}nuMA4+7;_1\">MIN_DISTANCE</field></block></value></block></value></block></value><statement name=\"DO0\"><block type=\"motor_motorStop\"><field name=\"motors\">maqueen.Motors.All</field><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.No</field><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"return\" numlines=\"1\"></mutation></block></next></block></next></block></statement><next><block type=\"controls_if\"><mutation elseif=\"2\" else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Arrête l'exécution de la fonction pour éviter les collisions\nDétection des capteurs de ligne</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-1</field></shadow></value></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO1\"><block type=\"variables_set\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></statement><value name=\"IF2\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO2\"><block type=\"variables_set\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"variables_set\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"96$KDuSi`R`++F|VG/oG\">previous_error</field></block></value></block></statement><next><block type=\"variables_change\"><field name=\"VAR\" id=\"dcXrZ*hvFz?q=BD)He3W\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">Maintient de l'erreur précédente si aucune ligne détectée\nPID</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"dcXrZ*hvFz?q=BD)He3W\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><value name=\"ccsc7jvhgdinuxi8yosa3\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"dcXrZ*hvFz?q=BD)He3W\">integral</field></block></value><value name=\"lh539rrrzldeprsm2ppw\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"6TA.Ph/%)9F?MB^%dglr\">INTEGRAL_LIMIT</field></block></value></block></value><value name=\"3v912koahdhynv7rq4pk\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"6TA.Ph/%)9F?MB^%dglr\">INTEGRAL_LIMIT</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"p;8I4Ebg{G}+,/^nH9`R\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">Anti-windup</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"96$KDuSi`R`++F|VG/oG\">previous_error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Qj}D%r/B^iW[sxFCa/A$\">correction</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><value name=\"ccsc7jvhgdinuxi8yosa3\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"LOXEq#_+XAtn(ozVRe,c\">Kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"+uv9od*T:!D?y$a{v;a[\">Ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"dcXrZ*hvFz?q=BD)He3W\">integral</field></block></value></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"bxX1gv|Um(5lC*9d;/SQ\">Kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"p;8I4Ebg{G}+,/^nH9`R\">derivative</field></block></value></block></value></block></value><value name=\"lh539rrrzldeprsm2ppw\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field></block></value></block></value><value name=\"3v912koahdhynv7rq4pk\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field><comment pinned=\"false\" h=\"80\" w=\"160\">Calcul des vitesses</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><value name=\"ccsc7jvhgdinuxi8yosa3\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"m1|?5CZ^K,}YU$]8ZtRU\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Qj}D%r/B^iW[sxFCa/A$\">correction</field></block></value></block></value><value name=\"lh539rrrzldeprsm2ppw\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"a-atZqn{#g#jW`%$w0rt\">MIN_SPEED</field></block></value><value name=\"3v912koahdhynv7rq4pk\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><value name=\"ccsc7jvhgdinuxi8yosa3\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"m1|?5CZ^K,}YU$]8ZtRU\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Qj}D%r/B^iW[sxFCa/A$\">correction</field></block></value></block></value><value name=\"lh539rrrzldeprsm2ppw\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"a-atZqn{#g#jW`%$w0rt\">MIN_SPEED</field></block></value><value name=\"3v912koahdhynv7rq4pk\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Envoi aux moteurs</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field></block></value></block></value></block></statement><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field></block></value></block></value></block></statement><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Enregistrement des données</comment><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"jHwOGRpr9nrtb9gRP?Ma\">left_speed</field></block></value></block></value><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"J#AGIUFM3d_4r.kC,NUC\">right_speed</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"96$KDuSi`R`++F|VG/oG\">previous_error</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mise à jour de l'erreur précédente</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Q.BS.j$J{W2:DR1_9WHP\">error</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"?k+X-kOS6IgUc@]EIVxw\">input_buton</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"logic_boolean\"><field name=\"BOOL\">FALSE</field></block></value><next><block type=\"dataloggersetcolumntitles\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"col1\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"col2\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"m1|?5CZ^K,}YU$]8ZtRU\">base_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">25</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"LOXEq#_+XAtn(ozVRe,c\">Kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">110</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"+uv9od*T:!D?y$a{v;a[\">Ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">9</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"bxX1gv|Um(5lC*9d;/SQ\">Kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">40</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"1=Rc8/[.w3?xBKm~(Pqx\">MAX_SPEED</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">40</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"6TA.Ph/%)9F?MB^%dglr\">INTEGRAL_LIMIT</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">20</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"WBI|@nC=/61h-Wr)==F.\">TIME_LIMIT</field><comment pinned=\"false\" h=\"80\" w=\"160\">Temps limite en millisecondes (15 secondes)</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">15000</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"HDZTfN_*q4Du|=c15q85\">start_time</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"`BSn@ehxA}nuMA4+7;_1\">MIN_DISTANCE</field><comment pinned=\"false\" h=\"80\" w=\"160\">Chronomètre initialisé au démarrage\nDistance minimale pour détecter un obstacle en centimètres</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">10</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"2105\" y=\"-52\"><mutation name=\"constrain\" functionid=\"/O|yZk(TC_TpD`_0EFp1\"><arg name=\"value\" id=\"ccsc7jvhgdinuxi8yosa3\" type=\"number\"></arg><arg name=\"min_val\" id=\"lh539rrrzldeprsm2ppw\" type=\"number\"></arg><arg name=\"max_val\" id=\"3v912koahdhynv7rq4pk\" type=\"number\"></arg></mutation><field name=\"function_name\">constrain</field><comment pinned=\"false\" h=\"80\" w=\"160\">Limite pour éviter l'intégration excessive</comment><value name=\"ccsc7jvhgdinuxi8yosa3\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">value</field></block></value><value name=\"lh539rrrzldeprsm2ppw\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">min_val</field></block></value><value name=\"3v912koahdhynv7rq4pk\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">max_val</field></block></value><statement name=\"STACK\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Contraint une valeur dans une plage donnée.</comment><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><block type=\"math_op2\"><field name=\"op\">min</field><value name=\"x\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">value</field></block></value><value name=\"y\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">max_val</field></block></value></block></value><value name=\"y\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">min_val</field></block></value></block></value></block></statement></block><"],[0,"/xml>"]],"start1":1190,"start2":1190,"length1":13,"length2":28752}]},{"type":"edited","filename":"main.py","patch":[{"diffs":[[0,"t\")\n"],[-1,"\n#Attention modifier la vitesse de base avec prudence maximum 40 (a partire de 30 l'éfficacité de la correction n'est plus assuré)\nbase_speed = 30\nKp = 110\nKi = 9\nKd = 40\n\n#MAX_SPEED peut etre augmenté de manière significative mais pas trop non plus pour évité\n# Les wind-up (fait que l'inégrale augmente trop, trop rapidement)"],[1,"base_speed = 30\nKp = 110\nKi = 9\nKd = 40"],[0,"\nMAX"]],"start1":370,"start2":370,"length1":335,"length2":47},{"diffs":[[0,"    "],[-1,"#Ici le code de modification du PID en fonction du temps:\n    if control.millis() - start_time <= 10000:\n        Kp_temps = Kp/2\n\n    else:\n        Kp_temps = Kp\n\n    "],[1,"\"\""],[0,"\n   "]],"start1":919,"start2":919,"length1":175,"length2":10}]},{"type":"edited","filename":"main.ts","patch":[{"diffs":[[0,"t\")\n"],[-1,"// Attention modifier la vitesse de base avec prudence maximum 40 (a partire de 30 l'éfficacité de la correction n'est plus assuré)\nlet base_speed = 30\nlet Kp = 110\nlet Ki = 9\nlet Kd = 40\n// MAX_SPEED peut etre augmenté de manière significative mais pas trop non plus pour évité\n//  Les wind-up (fait que l'inégrale augmente trop, trop rapidement)"],[1,"let base_speed = 30\nlet Kp = 110\nlet Ki = 9\nlet Kd = 40"],[0,"\nlet"]],"start1":430,"start2":430,"length1":355,"length2":63},{"diffs":[[0,") {\n"],[-1,"    let Kp_temps: number;\n"],[0,"    "]],"start1":796,"start2":796,"length1":34,"length2":8},{"diffs":[[0,"ver\n"],[-1,"    // Ici le code de modification du PID en fonction du temps:\n    if (control.millis() - start_time <= 10000) {\n        Kp_temps = Kp / 2\n    } else {\n        Kp_temps = Kp\n    }\n    \n"],[0,"    "]],"start1":1026,"start2":1026,"length1":194,"length2":8}]},{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0," ],\n"],[-1,"    \"testFiles\": [\n        \"test.ts\"\n    ],\n"],[0,"    "]],"start1":473,"start2":473,"length1":52,"length2":8}]},{"type":"added","filename":"test.ts","value":"// les tests vont ici ; cela ne sera pas compilé si ce paquet est utilisé en tant qu'extension.\n"}]}],"snapshots":[{"timestamp":1739289345830,"editorVersion":"7.0.57","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"vF#kcHf(HGewpl?)Z%2a\">error</variable><variable id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</variable><variable id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</variable><variable id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</variable><variable id=\"srTtG^Y7w^.knh-{c8E1\">derivative</variable><variable id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</variable><variable id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</variable><variable id=\"wx[A$s;C`-57WI8NLC+B\">Ki</variable><variable id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</variable><variable id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</variable><variable id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</variable><variable id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</variable><variable id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</variable><variable id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"dataloggersetcolumntitles\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"col1\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"col2\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">25</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">10</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"wx[A$s;C`-57WI8NLC+B\">Ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">4</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">50</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"device_forever\" x=\"381\" y=\"0\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation elseif=\"2\" else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Détection des capteurs</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-1</field></shadow></value></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO1\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></statement><value name=\"IF2\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO2\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field></block></value></block></statement><next><block type=\"variables_change\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">Maintient de l'erreur précédente si aucune ligne détectée\nPID</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field></block></value></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"srTtG^Y7w^.knh-{c8E1\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">Anti-windup</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wx[A$s;C`-57WI8NLC+B\">Ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field></block></value></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"srTtG^Y7w^.knh-{c8E1\">derivative</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field><comment pinned=\"false\" h=\"80\" w=\"160\">Calcul des vitesses</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field></block></value></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</field></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field></block></value></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</field></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Envoi aux moteurs</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></value></block></statement><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></value></block></statement><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Enregistrement des données</comment><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></value><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mise à jour de l'erreur précédente</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1650\" y=\"0\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><field name=\"function_name\">constrain</field><comment pinned=\"false\" h=\"80\" w=\"160\">Limite pour éviter l'intégration excessive</comment><value name=\"j7izah9rv7fhx25tbn1f\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">value</field></block></value><value name=\"vtmhtprg1v2xf223mko\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">min_val</field></block></value><value name=\"2errsbui1se12prib2co\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">max_val</field></block></value><statement name=\"STACK\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Contraint une valeur dans une plage donnée.</comment><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><block type=\"math_op2\"><field name=\"op\">min</field><value name=\"x\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">value</field></block></value><value name=\"y\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">max_val</field></block></value></block></value><value name=\"y\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">min_val</field></block></value></block></value></block></statement></block></xml>","main.ts":"","README.md":"","main.py":"# Limite pour éviter l'intégration excessive\ndef constrain(value: number, min_val: number, max_val: number):\n    # Contraint une valeur dans une plage donnée.\n    return max(min(value, max_val), min_val)\n\nright_speed = 0\nleft_speed = 0\ncorrection = 0\nderivative = 0\nintegral = 0\nprevious_error = 0\nerror = 0\ndatalogger.set_column_titles(\"left\", \"right\")\nbase_speed = 25\nKp = 110\nKi = 9\nKd = 40\nMAX_SPEED = 40\nINTEGRAL_LIMIT = 20\ninput_buton = False\n\n# Temps limite en millisecondes (15 secondes)\nTIME_LIMIT = 15000\nstart_time = control.millis()  # Chronomètre initialisé au démarrage\n\n# Distance minimale pour détecter un obstacle en centimètres\nMIN_DISTANCE = 10\n\ndef on_forever():\n    global error, integral, derivative, correction, left_speed, right_speed, previous_error, start_time\n    # Si le bouton A est préssé, input_buton passe a True\n    # et permet au programme présent dans la boucle\n    #while de s'activer\n    \n    if(input.button_is_pressed(Button.A)== True):\n        start_time = control.millis()\n        input_buton = True\n\n    if(input.button_is_pressed(Button.A) == True and input.button_is_pressed(Button.B) == True):\n        control.reset()\n\n    \n    while input_buton == True:\n        \n        \n        MIN_SPEED = 0\n\n        # Chronomètre : Arrêter le robot au bout du temps limite\n        # control.millis() - start_time équivaut au temps actuel\n        if control.millis() - start_time >= TIME_LIMIT:\n            maqueen.motor_stop(maqueen.Motors.ALL)\n            basic.show_icon(IconNames.SQUARE)  # Indique l'arrêt par le temps\n            return  # Arrête l'exécution de la fonction\n\n        # Détection des obstacles avec le capteur à ultrasons\n        distance = maqueen.ultrasonic()\n        if distance > 0 and distance < MIN_DISTANCE:\n            maqueen.motor_stop(maqueen.Motors.ALL)\n            basic.show_icon(IconNames.NO)  # Indique un obstacle\n            return  # Arrête l'exécution de la fonction pour éviter les collisions\n\n        # Détection des capteurs de ligne\n        if maqueen.read_patrol(maqueen.Patrol.PATROL_LEFT) == 1 and maqueen.read_patrol(maqueen.Patrol.PATROL_RIGHT) == 0:\n            error = -1\n        elif maqueen.read_patrol(maqueen.Patrol.PATROL_LEFT) == 0 and maqueen.read_patrol(maqueen.Patrol.PATROL_RIGHT) == 1:\n            error = 1\n        elif maqueen.read_patrol(maqueen.Patrol.PATROL_LEFT) == 1 and maqueen.read_patrol(maqueen.Patrol.PATROL_RIGHT) == 1:\n            error = 0\n        else:\n            error = previous_error  # Maintient de l'erreur précédente si aucune ligne détectée\n\n        # PID\n        integral += error\n        integral = constrain(integral, -INTEGRAL_LIMIT, INTEGRAL_LIMIT)  # Anti-windup\n        derivative = error - previous_error\n        correction = constrain(Kp * error + Ki * integral + Kd * derivative, -MAX_SPEED, MAX_SPEED)\n\n        # Calcul des vitesses\n        left_speed = constrain(base_speed - correction, MIN_SPEED, MAX_SPEED)\n        right_speed = constrain(base_speed + correction, MIN_SPEED, MAX_SPEED)\n\n        # Envoi aux moteurs\n        if left_speed >= 0:\n            maqueen.motor_run(maqueen.Motors.M1, maqueen.Dir.CW, left_speed)\n        else:\n            maqueen.motor_run(maqueen.Motors.M1, maqueen.Dir.CCW, abs(left_speed))\n        if right_speed >= 0:\n            maqueen.motor_run(maqueen.Motors.M2, maqueen.Dir.CW, right_speed)\n        else:\n            maqueen.motor_run(maqueen.Motors.M2, maqueen.Dir.CCW, abs(right_speed))\n\n        # Enregistrement des données\n        datalogger.log(datalogger.create_cv(\"left\", left_speed))\n        datalogger.log(datalogger.create_cv(\"right\", right_speed))\n\n        # Mise à jour de l'erreur précédente\n        previous_error = error\n\nbasic.forever(on_forever)\n","pxt.json":"{\n    \"name\": \"TEST PID\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\",\n        \"maqueen\": \"github:dfrobot/pxt-maqueen#v1.7.14\",\n        \"datalogger\": \"*\",\n        \"neopixel\": \"github:microsoft/pxt-neopixel#v0.7.6\",\n        \"servo\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"main.py\"\n    ],\n    \"targetVersions\": {\n        \"branch\": \"v7.0.57\",\n        \"tag\": \"v7.0.57\",\n        \"commits\": \"https://github.com/microsoft/pxt-microbit/commits/1a9e10ee33883477990f6bc7451dae38318586e3\",\n        \"target\": \"7.0.57\",\n        \"pxt\": \"11.1.13\"\n    },\n    \"preferredEditor\": \"pyprj\"\n}\n"}},{"timestamp":1741206556961,"editorVersion":"7.0.57","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"vF#kcHf(HGewpl?)Z%2a\">error</variable><variable id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</variable><variable id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</variable><variable id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</variable><variable id=\"srTtG^Y7w^.knh-{c8E1\">derivative</variable><variable id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</variable><variable id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</variable><variable id=\"wx[A$s;C`-57WI8NLC+B\">Ki</variable><variable id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</variable><variable id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</variable><variable id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</variable><variable id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</variable><variable id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</variable><variable id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"dataloggersetcolumntitles\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"col1\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"col2\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">25</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">10</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"wx[A$s;C`-57WI8NLC+B\">Ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">4</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">50</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"device_forever\" x=\"381\" y=\"0\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation elseif=\"2\" else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Détection des capteurs</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-1</field></shadow></value></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO1\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></statement><value name=\"IF2\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_operation\"><field name=\"OP\">AND</field><value name=\"A\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolLeft</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><value name=\"B\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"read_Patrol\"><field name=\"patrol\">maqueen.Patrol.PatrolRight</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value></block></value><statement name=\"DO2\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"variables_set\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field></block></value></block></statement><next><block type=\"variables_change\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">Maintient de l'erreur précédente si aucune ligne détectée\nPID</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field></block></value></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{[4Zk]5T[|:av?.Am:E@\">INTEGRAL_LIMIT</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"srTtG^Y7w^.knh-{c8E1\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">Anti-windup</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"K*}o)/q}R~F8.dT)@Z(x\">Kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wx[A$s;C`-57WI8NLC+B\">Ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`%7kYJAF2a7ea#c[]Mp!\">integral</field></block></value></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{Us=Fd-6SRexoIP%/!-r\">Kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"srTtG^Y7w^.knh-{c8E1\">derivative</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field><comment pinned=\"false\" h=\"80\" w=\"160\">Calcul des vitesses</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field></block></value></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</field></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><value name=\"j7izah9rv7fhx25tbn1f\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vqP6VvS/{t=bKSD*cNws\">base_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"bG~.8{6d)v_[GJ1Btz=h\">correction</field></block></value></block></value><value name=\"vtmhtprg1v2xf223mko\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"wzZKMD-D9w1^bwOE,yz*\">MIN_SPEED</field></block></value><value name=\"2errsbui1se12prib2co\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\".}GpgI!_Dbxkh^I6U,?^\">MAX_SPEED</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Envoi aux moteurs</comment><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M1</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></value></block></statement><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"motor_MotorRun\"><field name=\"index\">maqueen.Motors.M2</field><field name=\"Dir\">maqueen.Dir.CCW</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></value></block></statement><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Enregistrement des données</comment><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">left</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"aSc[e7$=5R*`8_uWRX,+\">left_speed</field></block></value></block></value><next><block type=\"dataloggerlog\" inline=\"true\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"data1\"><block type=\"dataloggercreatecolumnvalue\"><value name=\"column\"><shadow type=\"datalogger_columnfield\"><field name=\"column\">right</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"xMbd_z,L:H;Y(f(.w-ge\">right_speed</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"ZxS_WYS[]7hPDjwS51W6\">previous_error</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mise à jour de l'erreur précédente</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vF#kcHf(HGewpl?)Z%2a\">error</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1650\" y=\"0\"><mutation name=\"constrain\" functionid=\"E}#B`(SZmq=JTeJ!2`4Y\"><arg name=\"value\" id=\"j7izah9rv7fhx25tbn1f\" type=\"number\"></arg><arg name=\"min_val\" id=\"vtmhtprg1v2xf223mko\" type=\"number\"></arg><arg name=\"max_val\" id=\"2errsbui1se12prib2co\" type=\"number\"></arg></mutation><field name=\"function_name\">constrain</field><comment pinned=\"false\" h=\"80\" w=\"160\">Limite pour éviter l'intégration excessive</comment><value name=\"j7izah9rv7fhx25tbn1f\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">value</field></block></value><value name=\"vtmhtprg1v2xf223mko\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">min_val</field></block></value><value name=\"2errsbui1se12prib2co\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">max_val</field></block></value><statement name=\"STACK\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">Contraint une valeur dans une plage donnée.</comment><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><block type=\"math_op2\"><field name=\"op\">min</field><value name=\"x\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">value</field></block></value><value name=\"y\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">max_val</field></block></value></block></value><value name=\"y\"><block type=\"argument_reporter_number\"><field name=\"VALUE\">min_val</field></block></value></block></value></block></statement></block></xml>","main.ts":"","README.md":"","main.py":"# Limite pour éviter l'intégration excessive\ndef constrain(value: number, min_val: number, max_val: number):\n    # Contraint une valeur dans une plage donnée.\n    return max(min(value, max_val), min_val)\n\nright_speed = 0\nleft_speed = 0\ncorrection = 0\nderivative = 0\nintegral = 0\nprevious_error = 0\nerror = 0\ndatalogger.set_column_titles(\"left\", \"right\")\nbase_speed = 25\nKp = 110\nKi = 9\nKd = 40\nMAX_SPEED = 40\nINTEGRAL_LIMIT = 20\ninput_buton = False\n\n# Temps limite en millisecondes (15 secondes)\nTIME_LIMIT = 15000\nstart_time = control.millis()  # Chronomètre initialisé au démarrage\n\n# Distance minimale pour détecter un obstacle en centimètres\nMIN_DISTANCE = 10\n\ndef on_forever():\n    global error, integral, derivative, correction, left_speed, right_speed, previous_error, start_time\n    # Si le bouton A est préssé, input_buton passe a True\n    # et permet au programme présent dans la boucle\n    #while de s'activer\n    \n    if(input.button_is_pressed(Button.A)== True):\n        start_time = control.millis()\n        input_buton = True\n\n    if(input.button_is_pressed(Button.A) == True and input.button_is_pressed(Button.B) == True):\n        control.reset()\n\n    \n    while input_buton == True:\n        \n        \n        MIN_SPEED = 0\n\n        # Chronomètre : Arrêter le robot au bout du temps limite\n        # control.millis() - start_time équivaut au temps actuel\n        if control.millis() - start_time >= TIME_LIMIT:\n            maqueen.motor_stop(maqueen.Motors.ALL)\n            basic.show_icon(IconNames.SQUARE)  # Indique l'arrêt par le temps\n            return  # Arrête l'exécution de la fonction\n\n        # Détection des obstacles avec le capteur à ultrasons\n        distance = maqueen.ultrasonic()\n        if distance > 0 and distance < MIN_DISTANCE:\n            maqueen.motor_stop(maqueen.Motors.ALL)\n            basic.show_icon(IconNames.NO)  # Indique un obstacle\n            return  # Arrête l'exécution de la fonction pour éviter les collisions\n\n        # Détection des capteurs de ligne\n        if maqueen.read_patrol(maqueen.Patrol.PATROL_LEFT) == 1 and maqueen.read_patrol(maqueen.Patrol.PATROL_RIGHT) == 0:\n            error = -1\n        elif maqueen.read_patrol(maqueen.Patrol.PATROL_LEFT) == 0 and maqueen.read_patrol(maqueen.Patrol.PATROL_RIGHT) == 1:\n            error = 1\n        elif maqueen.read_patrol(maqueen.Patrol.PATROL_LEFT) == 1 and maqueen.read_patrol(maqueen.Patrol.PATROL_RIGHT) == 1:\n            error = 0\n        else:\n            error = previous_error  # Maintient de l'erreur précédente si aucune ligne détectée\n\n        # PID\n        integral += error\n        integral = constrain(integral, -INTEGRAL_LIMIT, INTEGRAL_LIMIT)  # Anti-windup\n        derivative = error - previous_error\n        correction = constrain(Kp * error + Ki * integral + Kd * derivative, -MAX_SPEED, MAX_SPEED)\n\n        # Calcul des vitesses\n        left_speed = constrain(base_speed - correction, MIN_SPEED, MAX_SPEED)\n        right_speed = constrain(base_speed + correction, MIN_SPEED, MAX_SPEED)\n\n        # Envoi aux moteurs\n        if left_speed >= 0:\n            maqueen.motor_run(maqueen.Motors.M1, maqueen.Dir.CW, left_speed)\n        else:\n            maqueen.motor_run(maqueen.Motors.M1, maqueen.Dir.CCW, abs(left_speed))\n        if right_speed >= 0:\n            maqueen.motor_run(maqueen.Motors.M2, maqueen.Dir.CW, right_speed)\n        else:\n            maqueen.motor_run(maqueen.Motors.M2, maqueen.Dir.CCW, abs(right_speed))\n\n        # Enregistrement des données\n        datalogger.log(datalogger.create_cv(\"left\", left_speed))\n        datalogger.log(datalogger.create_cv(\"right\", right_speed))\n\n        # Mise à jour de l'erreur précédente\n        previous_error = error\n\nbasic.forever(on_forever)\n","pxt.json":"{\n    \"name\": \"PID [FINAL]\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\",\n        \"maqueen\": \"github:dfrobot/pxt-maqueen#v1.7.14\",\n        \"datalogger\": \"*\",\n        \"neopixel\": \"github:microsoft/pxt-neopixel#v0.7.6\",\n        \"servo\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"main.py\"\n    ],\n    \"targetVersions\": {\n        \"branch\": \"v7.0.57\",\n        \"tag\": \"v7.0.57\",\n        \"commits\": \"https://github.com/microsoft/pxt-microbit/commits/1a9e10ee33883477990f6bc7451dae38318586e3\",\n        \"target\": \"7.0.57\",\n        \"pxt\": \"11.1.13\"\n    },\n    \"preferredEditor\": \"pyprj\"\n}\n"}}],"shares":[],"lastSaveTime":1741207895431}